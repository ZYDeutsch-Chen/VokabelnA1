<!DOCTYPE html>
<html lang="de" oncontextmenu="return false;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>至元德语 - A1德语动词表</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --success-color: #27ae60;
            --info-color: #2980b9;
            --warning-color: #f39c12;
            --danger-color: #c0392b;
            --light-gray: #f8f9fa;
            --dark-gray: #7f8c8d;
            --border-radius: 10px;
            --box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: var(--light-gray);
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
            -webkit-user-select: none; /* Safari */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* IE10+/Edge */
            user-select: none; /* Standard */
        }
        
        input, textarea {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
        
        h1 {
            text-align: center;
            margin: 20px 0 15px;
            color: var(--secondary-color);
            font-size: 2.2rem;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary-color);
            position: relative;
        }
        
        h1::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--accent-color);
            border-radius: 2px;
        }
        
        /* 快速导航 */
        .quick-nav {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            margin: 20px 0 25px;
            padding: 0 10px;
        }
        
        .nav-btn {
            padding: 10px 14px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
        }
        
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .nav-btn i {
            font-size: 0.9em;
        }
        
        .category {
            margin-bottom: 28px;
            box-shadow: var(--box-shadow);
            border-radius: var(--border-radius);
            overflow: hidden;
            background: white;
            transition: var(--transition);
        }
        
        .category:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }
        
        .category-header {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.9), rgba(44, 62, 80, 0.95));
            color: white;
            padding: 15px 20px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            position: relative;
        }
        
        .category-header:hover {
            background: linear-gradient(135deg, rgba(41, 128, 185, 0.9), rgba(52, 73, 94, 0.95));
        }
        
        .category-title {
            flex: 1;
            display: flex;
            align-items: center;
        }
        
        .verb-count {
            background: rgba(255, 255, 255, 0.25);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 1rem;
            margin-right: 15px;
            order: 1;
        }
        
        .toggle-icon {
            order: 2;
            margin-left: 10px;
            font-size: 0.9em;
            transition: var(--transition);
        }
        
        .verb-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }
        
        .verb-table th, .verb-table td {
            padding: 12px 10px;
            text-align: left;
            border: 1px solid #ddd;
        }
        
        .verb-table th {
            background-color: var(--light-color);
            text-align: center;
            font-weight: 600;
            color: var(--secondary-color);
            position: sticky;
            top: 0;
        }
        
        .col-verb { 
            width: 12%; 
            font-size: 1.05em;
            font-weight: 600;
        }
        
        .col-pres { width: 10%; }
        .col-pii { width: 11%; }
        .col-eg { width: 35%; }
        .col-meaning { width: 10%; }
        .col-valence { width: 22%; }
        
        .akk-bg {
            background-color: var(--success-color);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
            font-size: 0.9em;
        }
        
        .dat-bg {
            background-color: var(--info-color);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
            font-size: 0.9em;
        }
        
        .reflexive-bg {
            background-color: var(--warning-color);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
            font-size: 0.9em;
        }
        
        .valence-pattern {
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }
        
        .valence-pattern u {
            text-decoration: underline;
            font-style: italic;
        }
        
        .verb {
            font-weight: bold;
            color: var(--secondary-color);
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: var(--dark-gray);
            font-size: 0.9em;
            border-top: 1px solid #ddd;
            background: var(--light-color);
            border-radius: var(--border-radius);
        }
        
        .footer p {
            margin: 5px 0;
        }
        
        /* 移动端适配 */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.8rem;
                margin: 10px 0 15px;
            }
            
            .quick-nav {
                gap: 6px;
                margin: 15px 0 20px;
            }
            
            .nav-btn {
                padding: 8px 12px;
                font-size: 0.8rem;
                flex-basis: calc(50% - 6px);
                justify-content: center;
            }
            
            .category-header {
                padding: 12px 15px;
                font-size: 1.1rem;
            }
            
            .verb-count {
                font-size: 0.9rem;
                padding: 4px 8px;
                margin-right: 10px;
            }
            
            .category-title span {
                font-size: 1rem;
            }
            
            /* 隐藏桌面端表格 */
            .desktop-view {
                display: none;
            }
            
            /* 移动端卡片视图 */
            .mobile-view {
                display: block;
                padding: 12px;
            }
            
            .verb-card {
                margin-bottom: 12px;
                padding: 12px;
                border: 1px solid #eee;
                border-radius: 8px;
                background: #fff;
                box-shadow: 0 2px 5px rgba(0,0,0,0.05);
                line-height: 1.4;
            }
            
            .verb-card-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 8px;
                padding-bottom: 6px;
                border-bottom: 1px dashed #eee;
            }
            
            .verb-name {
                font-weight: bold;
                font-size: 1.1em;
                color: var(--secondary-color);
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
                flex: 1;
            }
            
            .verb-forms {
                display: flex;
                gap: 12px;
                font-size: 0.9em;
                color: var(--dark-gray);
                flex-shrink: 0;
                margin-left: 8px;
            }
            
            .verb-pres, .verb-pii {
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 80px;
            }
            
            .verb-card-main {
                margin-bottom: 8px;
            }
            
            .verb-eg {
                line-height: 1.3;
                font-size: 0.95em;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                margin: 4px 0;
            }
            
            .verb-eg .akk-bg, .verb-eg .dat-bg {
                font-size: 1em;
                padding: 1px 4px;
            }
            
            .verb-card-footer {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding-top: 6px;
                border-top: 1px dashed #eee;
            }
            
            .verb-valence {
                font-family: Arial, sans-serif;
                font-size: 0.9em;
                flex: 2;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
                letter-spacing: -0.3px;
            }
            
            .verb-meaning {
                font-style: italic;
                color: var(--primary-color);
                font-size: 0.9em;
                text-align: right;
                flex: 1;
                margin-left: 8px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                padding-right: 8px;
            }
            
            /* 针对长文本的调整 */
            .long-text {
                font-size: 0.85em;
            }
            
            .very-long-text {
                font-size: 0.8em;
            }
        }
        
        /* 桌面端样式 */
        @media (min-width: 769px) {
            .mobile-view {
                display: none;
            }
            
            .desktop-view {
                display: block;
            }
        }
        
        /* 滚动到顶部按钮 */
        .scroll-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: var(--transition);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
        }
        
        .scroll-top.show {
            opacity: 1;
            visibility: visible;
        }
        
        .scroll-top:hover {
            background: var(--secondary-color);
            transform: translateY(-3px);
        }
        
        .category-content {
            transition: var(--transition);
        }
        
        .collapsed .toggle-icon {
            transform: rotate(180deg);
        }
        
        .collapsed .category-content {
            display: none;
        }
    </style>
</head>
<body>

<h1>至元德语 - A1德语动词表</h1>

<!-- 快速导航 -->
<div class="quick-nav">
    <button class="nav-btn" onclick="scrollToCategory('category1')"><i class="fas fa-walking"></i> 不及物</button>
    <button class="nav-btn" onclick="scrollToCategory('category2')"><i class="fas fa-equals"></i> 系动词</button>
    <button class="nav-btn" onclick="scrollToCategory('category3')"><i class="fas fa-bullseye"></i> 直宾</button>
    <button class="nav-btn" onclick="scrollToCategory('category4')"><i class="fas fa-hands-helping"></i> 受益</button>
    <button class="nav-btn" onclick="scrollToCategory('category5')"><i class="fas fa-gift"></i> 受益+直宾</button>
    <button class="nav-btn" onclick="scrollToCategory('category6')"><i class="fas fa-brain"></i> 情态</button>
    <button class="nav-btn" onclick="scrollToCategory('category7')"><i class="fas fa-retweet"></i> 反身</button>
</div>

<!-- 动词分类容器 -->
<div id="categories-container"></div>

<div class="footer">
    <p id="total-count">总计: 176个 | 标注：三格(<span class="dat-bg">Dat</span>) 四格(<span class="akk-bg">Akk</span>) </p>
    <p>© 2025 至元德语. 保留所有权利.</p>
    <p>A1动词| 至元德语内部资料  | 转载请注明出处</p>
</div>

<!-- 滚动到顶部按钮 -->
<div class="scroll-top" id="scrollTop">
    <i class="fas fa-arrow-up"></i>
</div>

<script>
    // 密码验证
    async function checkPassword() {
        try {
            // 从GitHub获取密码文件
            const response = await fetch('https://zydeutsch-chen.github.io/VokabelnA1/a1-secret-verbs.txt');
            const text = await response.text();
            
            // 解析密码
            const password = text.split('=')[1];
            
            // 检查本地存储的密码
            const storedPassword = localStorage.getItem('a1-secret-password');
            
            // 如果没有存储的密码或者密码不匹配
            if (!storedPassword || storedPassword !== password) {
                // 存储新密码
                localStorage.setItem('a1-secret-password', password);
                
                // 如果之前有存储的密码但不匹配，说明密码已更改，破坏显示
                if (storedPassword) {
                    corruptData();
                }
            }
        } catch (error) {
            console.error('密码验证失败:', error);
            // 即使验证失败也允许显示内容
        }
    }
    
    // 数据破坏函数
    function corruptData() {
        // 破坏动词数据，显示"至元德语内部资料"的中英文交替行
        for (let i = 0; i < verbs.length; i++) {
            // 中英文交替显示
            if (i % 2 === 0) {
                verbs[i].infinitive = "至元德语内部资料";
                verbs[i].example = "Zhì Yuán Dé Yǔ Nèi Bù Zī Liào";
                verbs[i].meaning = "Confidential Materials";
                verbs[i].valence = "-----";
            } else {
                verbs[i].infinitive = "Zhì Yuán Dé Yǔ Nèi Bù Zī Liào";
                verbs[i].example = "至元德语内部资料";
                verbs[i].meaning = "内部资料";
                verbs[i].valence = "*****";
            }
            
            // 清空其他字段
            verbs[i].pres3 = "";
            verbs[i].pii = "";
        }
    }
    
    // 从远程加载动词数据
    async function loadVerbsData() {
        try {
            const response = await fetch('https://zydeutsch-chen.github.io/VokabelnA1/a1_constverbs1.json');
            const text = await response.text();
            // 移除可能的BOM标记并解析JSON
            const cleanText = text.trim().replace(/^\uFEFF/, '');
            const data = JSON.parse(cleanText);
            return data;
        } catch (error) {
            console.error('加载动词数据失败:', error);
            return [];
        }
    }
    
    // 类别元数据
    const categoryMeta = {
        category1: { id: "category1", title: "1. 不及物动词", desktopTitle: "1. 主语 + 动词", count: 45 },
        category2: { id: "category2", title: "2. 系动词", desktopTitle: "2. 主语 + 系动词 + 表语", count: 15 },
        category3: { id: "category3", title: "3. <span class=\"akk-bg\">直接宾语</span>", desktopTitle: "3. 主语 + 动作 + <span class=\"akk-bg\">直接宾语</span>", count: 88 },
        category4: { id: "category4", title: "4. <span class=\"dat-bg\">受益者</span>", desktopTitle: "4. 主语 + 动作 + <span class=\"dat-bg\">受益者</span>", count: 9 },
        category5: { id: "category5", title: "5. <span class=\"dat-bg\">受益者</span>+<span class=\"akk-bg\">宾语</span>", desktopTitle: "5. 主语 + 动作 + <span class=\"dat-bg\">受益者</span> + <span class=\"akk-bg\">直接宾语</span>", count: 7 },
        category6: { id: "category6", title: "6. 情态动词", desktopTitle: "6. 主语 + 情态动词 + 动词原形", count: 6 },
        category7: { id: "category7", title: "7. 反身动词", desktopTitle: "7. 主语 + 反身动词 + sich", count: 6 }
    };
    
    // 动词数据（初始化为空数组，将从远程加载）
    let verbs = [];

    // 排序函数
    function sortVerbs(verbs) {
        return verbs.sort((a, b) => {
            // 1. 单三和PII都为空 -> 排在最前面
            const aBothEmpty = (!a.pres3 || a.pres3 === "") && (!a.pii || a.pii === "");
            const bBothEmpty = (!b.pres3 || b.pres3 === "") && (!b.pii || b.pii === "");
            
            if (aBothEmpty && !bBothEmpty) return -1;
            if (!aBothEmpty && bBothEmpty) return 1;
            
            // 2. 单三为空，PII不为空 -> 排在中间
            const aPresEmptyPiiNotEmpty = (!a.pres3 || a.pres3 === "") && (a.pii && a.pii !== "");
            const bPresEmptyPiiNotEmpty = (!b.pres3 || b.pres3 === "") && (b.pii && b.pii !== "");
            
            if (aPresEmptyPiiNotEmpty && !bPresEmptyPiiNotEmpty) return -1;
            if (!aPresEmptyPiiNotEmpty && bPresEmptyPiiNotEmpty) return 1;
            
            // 3. 单三和PII都不为空 -> 排在最后
            const aBothNotEmpty = (a.pres3 && a.pres3 !== "") && (a.pii && a.pii !== "");
            const bBothNotEmpty = (b.pres3 && b.pres3 !== "") && (b.pii && b.pii !== "");
            
            if (aBothNotEmpty && !bBothNotEmpty) return 1;
            if (!aBothNotEmpty && bBothNotEmpty) return -1;
            
            // 4. 在单三和PII都不为空的情况下，PII带*的排在后面
            if (aBothNotEmpty && bBothNotEmpty) {
                const aHasStar = a.pii.includes('*');
                const bHasStar = b.pii.includes('*');
                
                if (aHasStar && !bHasStar) return 1;
                if (!aHasStar && bHasStar) return -1;
            }
            
            // 5. 配价带介词宾语的动词排在最后
            const aHasPreposition = a.valence.includes('[');
            const bHasPreposition = b.valence.includes('[');
            
            if (aHasPreposition && !bHasPreposition) return 1;
            if (!aHasPreposition && bHasPreposition) return -1;
            
            // 6. 相同词干的动词靠近排列
            const aStem = a.infinitive.replace(/^(sich|ab|an|auf|aus|ein|mit|um|vor|zu)/, '');
            const bStem = b.infinitive.replace(/^(sich|ab|an|auf|aus|ein|mit|um|vor|zu)/, '');
            
            return aStem.localeCompare(bStem);
        });
    }

    // 渲染函数
    function renderCategories() {
        const container = document.getElementById('categories-container');
        container.innerHTML = '';
        
        let totalCount = 0;
        
        Object.values(categoryMeta).forEach(category => {
            const categoryVerbs = verbs.filter(v => v.category === category.id);
            totalCount += categoryVerbs.length;
            
            const sortedVerbs = sortVerbs(categoryVerbs);
            
            const categoryElement = document.createElement('div');
            categoryElement.className = 'category';
            categoryElement.id = category.id;
            
            const header = document.createElement('div');
            header.className = 'category-header';
            
            const titleContainer = document.createElement('div');
            titleContainer.className = 'category-title';
            
            // 添加数量统计
            const countSpan = document.createElement('span');
            countSpan.className = 'verb-count';
            countSpan.textContent = `${categoryVerbs.length}个`;
            titleContainer.appendChild(countSpan);
            
            // 添加标题
            const titleSpan = document.createElement('span');
            
            // 根据屏幕宽度选择标题
            if (window.innerWidth <= 768) {
                titleSpan.innerHTML = category.title;
            } else {
                titleSpan.innerHTML = category.desktopTitle;
            }
            
            titleContainer.appendChild(titleSpan);
            
            // 添加折叠图标
            const toggleIcon = document.createElement('i');
            toggleIcon.className = 'fas fa-chevron-down toggle-icon';
            titleContainer.appendChild(toggleIcon);
            
            header.appendChild(titleContainer);
            
            header.addEventListener('click', function() {
                const content = this.nextElementSibling;
                if (content.style.display === 'none') {
                    content.style.display = 'block';
                    this.classList.remove('collapsed');
                } else {
                    content.style.display = 'none';
                    this.classList.add('collapsed');
                }
            });
            
            const content = document.createElement('div');
            content.className = 'category-content';
            
            // 桌面视图
            const desktopView = document.createElement('div');
            desktopView.className = 'desktop-view';
            
            const table = document.createElement('table');
            table.className = 'verb-table';
            
            const thead = document.createElement('thead');
            thead.innerHTML = `
                <tr>
                    <th class="col-verb">动词</th>
                    <th class="col-pres">单三</th>
                    <th class="col-pii">PII</th>
                    <th class="col-eg">例句</th>
                    <th class="col-meaning">释义</th>
                    <th class="col-valence">配价格式</th>
                </tr>
            `;
            
            const tbody = document.createElement('tbody');
            sortedVerbs.forEach(verb => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="col-verb verb">${verb.infinitive}</td>
                    <td class="col-pres">${verb.pres3 || ''}</td>
                    <td class="col-pii">${verb.pii || ''}</td>
                    <td class="col-eg">${verb.example}</td>
                    <td class="col-meaning">${verb.meaning}</td>
                    <td class="col-valence valence-pattern">${verb.valence}</td>
                `;
                tbody.appendChild(row);
            });
            
            table.appendChild(thead);
            table.appendChild(tbody);
            desktopView.appendChild(table);
            
            // 移动视图
            const mobileView = document.createElement('div');
            mobileView.className = 'mobile-view';
            
            sortedVerbs.forEach(verb => {
                const card = document.createElement('div');
                card.className = 'verb-card';
                
                // 检查文本长度并应用适当的类
                const formsLength = (verb.pres3 || '').length + (verb.pii || '').length;
                const exampleLength = verb.example.length;
                const valenceLength = verb.valence.length;
                
                const formsClass = formsLength > 20 ? 'long-text' : formsLength > 30 ? 'very-long-text' : '';
                const exampleClass = exampleLength > 40 ? 'long-text' : exampleLength > 60 ? 'very-long-text' : '';
                const valenceClass = valenceLength > 30 ? 'long-text' : valenceLength > 50 ? 'very-long-text' : '';
                
                card.innerHTML = `
                    <div class="verb-card-header">
                        <span class="verb-name">${verb.infinitive}</span>
                        <div class="verb-forms ${formsClass}">
                            ${verb.pres3 ? `<span class="verb-pres">${verb.pres3}</span>` : ''}
                            ${verb.pii ? `<span class="verb-pii">${verb.pii}</span>` : ''}
                        </div>
                    </div>
                    <div class="verb-card-main">
                        <div class="verb-eg ${exampleClass}">${verb.example}</div>
                    </div>
                    <div class="verb-card-footer">
                        <div class="verb-valence ${valenceClass}">${verb.valence}</div>
                        <div class="verb-meaning">${verb.meaning}</div>
                    </div>
                `;
                
                mobileView.appendChild(card);
            });
            
            content.appendChild(desktopView);
            content.appendChild(mobileView);
            
            categoryElement.appendChild(header);
            categoryElement.appendChild(content);
            
            container.appendChild(categoryElement);
        });
        
        document.getElementById('total-count').innerHTML = `总计: ${totalCount}个 | 标注：三格(<span class="dat-bg">Dat</span>) 四格(<span class="akk-bg">Akk</span>)`;
    }

    // 滚动到指定类别
    function scrollToCategory(categoryId) {
        const element = document.getElementById(categoryId);
        if (element) {
            element.scrollIntoView({behavior: "smooth"});
        }
    }
    
    // 显示/隐藏滚动到顶部按钮
    window.addEventListener('scroll', function() {
        const scrollTopButton = document.getElementById('scrollTop');
        if (window.pageYOffset > 300) {
            scrollTopButton.classList.add('show');
        } else {
            scrollTopButton.classList.remove('show');
        }
    });
    
    // 滚动到顶部
    document.getElementById('scrollTop').addEventListener('click', function() {
        window.scrollTo({top: 0, behavior: 'smooth'});
    });

    // 初始化
    document.addEventListener('DOMContentLoaded', function() {
        // 加载动词数据并执行密码验证
        loadVerbsData().then(verbsData => {
            // 将加载的动词数据赋值给全局变量
            window.verbs = verbsData;
            
            // 执行密码验证
            checkPassword().then(() => {
                // 密码验证完成后渲染页面
                renderCategories();
            });
        }).catch(error => {
            console.error('加载数据失败:', error);
        });
        
        // 窗口大小变化时重新渲染以更新标题
        window.addEventListener('resize', renderCategories);
    });
    
    // 禁用某些键盘快捷键
    document.addEventListener('keydown', function(e) {
        // 禁用 F12
        if (e.keyCode == 123) {
            e.preventDefault();
            return false;
        }
        // 禁用 Ctrl+Shift+I
        if (e.ctrlKey && e.shiftKey && e.keyCode == 73) {
            e.preventDefault();
            return false;
        }
        // 禁用 Ctrl+Shift+J
        if (e.ctrlKey && e.shiftKey && e.keyCode == 74) {
            e.preventDefault();
            return false;
        }
        // 禁用 Ctrl+U
        if (e.ctrlKey && e.keyCode == 85) {
            e.preventDefault();
            return false;
        }
        // 禁用 Ctrl+S
        if (e.ctrlKey && e.keyCode == 83) {
            e.preventDefault();
            return false;
        }
    });
</script>
</body>
</html>
